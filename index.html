<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AML Ticketing — Submit</title>

<style>
  /* --- General Styles --- */
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 30px;
    color: #333;
  }

  .card {
    max-width: 760px;
    margin: 0 auto;
    background: #fff;
    padding: 32px;
    border-radius: 16px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.08);
    transition: transform 0.2s ease;
  }
  .card:hover { transform: translateY(-4px); }

  h1 {
    text-align: center;
    color: #004466;
    font-size: 30px;
    margin-bottom: 28px;
    font-weight: 700;
  }

  label {
    display: block;
    margin-top: 16px;
    font-weight: 600;
    font-size: 14px;
  }

  input, select, textarea {
    width: 100%;
    padding: 12px;
    margin-top: 6px;
    border: 1px solid #d1d9e0;
    border-radius: 10px;
    font-size: 14px;
    background: #f9fafb;
    transition: border 0.2s, box-shadow 0.2s;
  }

  input:focus, select:focus, textarea:focus {
    border-color: #005c3c;
    box-shadow: 0 0 6px rgba(0,92,60,0.2);
    outline: none;
  }

  .row {
    display: flex;
    gap: 16px;
    margin-top: 10px;
  }
  .col { flex: 1; }
  @media (max-width:700px) { .row { flex-direction: column; } }

  /* --- Button --- */
  button {
    background: #005c3c;
    color: #fff;
    border: none;
    padding: 14px;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 24px;
    width: 100%;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  button:hover { opacity: 0.9; transform: scale(1.02); }
  button.loading {
    pointer-events: none;
    opacity: 0.6;
  }
  button.loading::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid #fff;
    border-top: 2px solid #004466;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(360deg);}
  }

  /* --- Status Message --- */
  .status {
    margin-top: 18px;
    font-weight: 600;
    font-size: 15px;
    text-align: center;
    opacity: 0;
    transition: opacity 0.4s ease;
  }
  .status.show { opacity: 1; }

</style>
</head>

<body>
<div class="card">
  <h1>AML Ticketing Form</h1>

  <form id="ticketForm" enctype="multipart/form-data" method="POST">
    <label for="customerName">Customer Name</label>
    <input id="customerName" name="customerName" type="text" required>

    <label for="branchName">Branch Name</label>
    <input id="branchName" name="branchName" type="text" required>

    <div class="row">
      <div class="col">
        <label for="area">Area</label>
        <select id="area" name="area" required>
          <option value="">Select Area</option>
          <option>BAG-GUET</option>
          <option>CAGAYAN</option>
          <option>ILOCOS NORTE</option>
          <option>ILOCOS SUR-ABRA</option>
          <option>ISABELA</option>
          <option>LA UNION</option>
          <option>PANGASINAN EAST</option>
          <option>PANGASINAN WEST</option>
          <option>NUEVA VIZCAYA</option>
          <option>PAMPANGA</option>
          <option>TARLAC</option>
          <option>ZAMBAT</option>
          <option>NUEVA ECIJA</option>
          <option>NUEVA ECIJA - AURORA</option>
          <option>SOUTH BULACAN</option>
          <option>NORTH BULACAN</option>
          <option>Northwestern Manila</option>
          <option>Central Western Manila</option>
          <option>Northeastern Manila</option>
          <option>Southwestern Manila</option>
          <option>Southeastern Manila</option>
          <option>CAVITE WEST</option>
          <option>CAVITE SOUTH</option>
          <option>CAVITE NORTH</option>
          <option>RIZAL</option>
          <option>LAGUNA WEST</option>
          <option>LAGUNA EAST</option>
          <option>PALAWAN</option>
          <option>ALCASOR</option>
          <option>BATANGAS EAST</option>
          <option>BATANGAS WEST</option>
          <option>CAMARINES</option>
          <option>MASBATE</option>
          <option>MINDORO</option>
          <option>QUEMAR</option>
          <option>AKLAN</option>
          <option>ANTIQUE</option>
          <option>CAPIZRON</option>
          <option>ILOILO NORTH</option>
          <option>ILOILO SOUTH</option>
          <option>NEGOCC NORTH</option>
          <option>NEGOCC SOUTH</option>
          <option>ORNEG</option>
          <option>BOHOL</option>
          <option>CEBU NORTH</option>
          <option>CEBU SOUTH</option>
          <option>CEBU WEST</option>
          <option>CEBU CENTRAL</option>
          <option>NOLEY</option>
          <option>SAMAR EAST</option>
          <option>SAMAR WEST</option>
          <option>SOLEY</option>
          <option>BUKIDNON</option>
          <option>CDO CITY PLUS</option>
          <option>NORMIN WEST</option>
          <option>ZAMBOANGA CITY PLUS</option>
          <option>ZAMBOPEN NORTH</option>
          <option>ZAMBOPEN SOUTH</option>
          <option>CARAGA EAST</option>
          <option>CARAGA WEST</option>
          <option>DAVAO CITY PLUS</option>
          <option>NORTHEAST DAVO</option>
          <option>COTABATO NORTH</option>
          <option>MAGUINDANAO PLUS</option>
          <option>SOCSKSARGEN EAST</option>
          <option>SOCSKSARGEN WEST</option>
        </select>
      </div>

      <div class="col">
        <label for="category">Category</label>
        <select id="category" name="category" required>
          <option value="">Select Category</option>
          <option>Business Permits</option>
          <option>Valid ID</option>
          <option>Mayors Permit</option>
          <option>Barangay Permit</option>
          <option>DTI Permit</option>
          <option>Sec Permit</option>
          <option>Others</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label for="priority">Priority</label>
        <select id="priority" name="priority">
          <option>Low</option>
          <option selected>Medium</option>
          <option>High</option>
        </select>
      </div>

      <div class="col">
        <label for="status">Status</label>
        <select id="status" name="status">
          <option selected>New</option>
          <option>In Progress</option>
          <option>Resolved</option>
          <option>Closed</option>
        </select>
      </div>
    </div>

    <label for="assignee">Assignee</label>
    <input id="assignee" name="assignee" type="text" placeholder="Enter assignee name">

    <label for="attachments">Attachments (images / PDF, max 10MB each)</label>
    <input id="attachments" name="attachments" type="file" multiple accept=".pdf,image/*">

    <button type="submit" id="submitBtn">Submit Ticket</button>
    <div id="statusMsg" class="status"></div>
  </form>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyvEhKm92_OD9BY5taFzD5DQ39B-qwgQzgG-SGJzj8yFtDI0Wp5CaRtMNKsE40KoMOR/exec";

const form = document.getElementById("ticketForm");
const attachmentsInput = document.getElementById("attachments");
const statusMsg = document.getElementById("statusMsg");
const submitBtn = document.getElementById("submitBtn");

form.addEventListener("submit", async (ev) => {
  ev.preventDefault();

  statusMsg.classList.remove("show");
  statusMsg.style.color = "gray";
  statusMsg.textContent = "Submitting...";
  submitBtn.classList.add("loading");

  const fd = new FormData(form);

  try {
    // Validate file sizes
    for (let f of attachmentsInput.files) {
      if (f.size > 10 * 1024 * 1024)
        throw new Error("File too large: " + f.name);
      fd.append("file", f, f.name);
    }

    const res = await fetch(WEB_APP_URL, { method: "POST", body: fd });
    const json = await res.json();

    if (!json.success) throw new Error(json.message);

    statusMsg.textContent = "✓ Ticket created: " + json.ticketId;
    statusMsg.style.color = "green";

    form.reset();

  } catch (err) {
    statusMsg.textContent = "❌ " + err.message;
    statusMsg.style.color = "red";
  }

  submitBtn.classList.remove("loading");
  submitBtn.textContent = "Submit Ticket";
  statusMsg.classList.add("show");
});
</script>
</body>
</html>
